<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–∑–µ—Ä–≤–∞—Ü–∏—è | –†–µ—Å—Ç–æ—Ä–∞–Ω—Ç "–í–∫—É—Å–Ω–æ"</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Flatpickr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

</head>
<body class="bg-light">

  <div class="container mt-5 mb-5">
    <h1 id="reservation-title" class="text-center mb-4 text-danger fw-bold">üìÖ –ù–∞–ø—Ä–∞–≤–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—è</h1>

    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card shadow border-0">
            <div class="card-body p-4">
                <form>
                  <div class="mb-3">
                    <label for="name" class="form-label">–ò–º–µ –∏ —Ñ–∞–º–∏–ª–∏—è *</label>
                    <input type="text" class="form-control" id="name" name="name" autocomplete="name" placeholder="–í–∞—à–µ—Ç–æ –∏–º–µ" required>
                  </div>
              
                  <div class="mb-3">
                    <label for="phone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                    <input type="tel" class="form-control" id="phone" name="phone" autocomplete="tel" placeholder="+359..." required>
                  </div>
              
                  <div class="mb-3">
                    <label for="guests" class="form-label">–ë—Ä–æ–π –≥–æ—Å—Ç–∏ *</label>
                    <input type="number" class="form-control" id="guests" name="guests" autocomplete="off" min="1" required>
                    <div id="guest-error" class="text-danger fst-italic mt-1" style="display: none;">
                      –ú–∞–∫—Å–∏–º–∞–ª–Ω–∏—è—Ç –±—Ä–æ–π –≥–æ—Å—Ç–∏ –µ 50.
                    </div>
                  </div>
                  
              
                  <div class="mb-3">
                    <label for="date" class="form-label">–î–∞—Ç–∞ *</label>
                    <input type="text" class="form-control" id="date" name="date" autocomplete="off" required placeholder="–ò–∑–±–µ—Ä–∏ –¥–∞—Ç–∞">
                  </div>
              
                  <div class="mb-3">
                    <label for="time" class="form-label">–ß–∞—Å *</label>
                    <input type="text" class="form-control" id="time" name="time" autocomplete="off" required placeholder="–ò–∑–±–µ—Ä–∏ —á–∞—Å">
                  </div>
              
                  <div class="mb-3">
                    <label for="message" class="form-label">–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–æ —Å—ä–æ–±—â–µ–Ω–∏–µ</label>
                    <textarea class="form-control" id="message" name="message" autocomplete="off" rows="3" placeholder="–ò–º–∞—Ç–µ –ª–∏ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è?"></textarea>
                  </div>
              
                  <button type="submit" class="btn btn-danger w-100 fw-bold">–ò–∑–ø—Ä–∞—Ç–∏ –∑–∞—è–≤–∫–∞</button>
                </form>
                <div id="success-message" class="text-center" style="display: none;">
                    <div style="font-size: 80px;">‚úÖ</div>
                    <h3 class="text-success mt-3">–ó–∞—è–≤–∫–∞—Ç–∞ –±–µ—à–µ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!</h3>
                    <p class="text-muted mt-2 fst-italic">–û—á–∞–∫–≤–∞–π—Ç–µ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –∑–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—è—Ç–∞ –Ω–∞ –ø–æ—Å–æ—á–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω!</p>
                  </div>
                  
            </div>  
        </div>
      </div>
    </div>
  </div>
<!-- Flatpickr core -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<!-- Flatpickr Bulgarian locale -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/bg.js"></script>

<script>
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –¥–∞—Ç–∞ (—Å –±—ä–ª–≥–∞—Ä—Å–∫–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–±—Ä–∞–Ω–∞ –Ω–∞ –º–∏–Ω–∞–ª–∏ –¥–Ω–∏)
  flatpickr("#date", {
    locale: "bg",
    dateFormat: "d.m.Y",
    minDate: "today"
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —á–∞—Å (—Å 24-—á–∞—Å–æ–≤ —Ñ–æ—Ä–º–∞—Ç –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª)
  flatpickr("#time", {
    locale: "bg",
    enableTime: true,
    noCalendar: true,
    dateFormat: "H:i",
    time_24hr: true,
    minTime: "10:00",
    maxTime: "22:00"
  });

  // –°–≤—ä—Ä–∂–∏ —Å–µ —Å—ä—Å Supabase
  const supabase = window.supabase.createClient(
    'https://huullvfombogfhmssqrc.supabase.co', // –¢–≤–æ—è—Ç –ø—Ä–æ–µ–∫—Ç–µ–Ω URL
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1dWxsdmZvbWJvZ2ZobXNzcXJjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4NDIyNzAsImV4cCI6MjA2MDQxODI3MH0.7UGhnlUl3FkTQBW9YNTAvbrv5v3GWuRawGlZJAEg5UY' // anon –∫–ª—é—á
  );

  // –°–ª—É—à–∞–π –∑–∞ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞
  document.querySelector("form").addEventListener("submit", async function (e) {
    e.preventDefault();

    // –°—ä–±–µ—Ä–∏ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç –ø–æ–ª–µ—Ç–∞—Ç–∞
    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const guestsInput = document.getElementById("guests");
    const guestError = document.getElementById("guest-error");
    const guests = parseInt(guestsInput.value.trim(), 10);

    if (isNaN(guests) || guests > 50) {
      guestError.style.display = "block";
      guestsInput.classList.add("is-invalid");
      return;
    } else {
      guestError.style.display = "none";
      guestsInput.classList.remove("is-invalid");
    }


    const dateInput = document.getElementById("date").value;
    const [day, month, year] = dateInput.split(".");
    const date = `${year}-${month}-${day}`;
    const time = document.getElementById("time").value;
    const message = document.getElementById("message").value.trim();

    // –ó–∞–ø–∏—Å –≤ Supabase
    const { error } = await supabase
      .from("reservation")
      .insert([{ name, phone, guests, date, time, message }]);

    if (error) {
      alert("‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ. –ú–æ–ª—è, –æ–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.");
      console.error(error);
    } else {
        document.querySelector("form").style.display = "none";
        document.getElementById("reservation-title").style.display = "none";
        document.getElementById("success-message").style.display = "block";


    }
  });
</script>



</body>
</html>
